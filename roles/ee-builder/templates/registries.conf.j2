# Contents of the file: ee-containers/roles/ee-builder/templates/registries.conf.j2

# Podman registries configuration file
# This file is generated dynamically based on the provided variables.

# Registry configuration for containers
unqualified-search-registries = ["registry.access.redhat.com", "docker.io"]

{% if rh_username is defined and rh_username | length > 0 %}
[[registry]]
prefix = "registry.redhat.io"
location = "registry.redhat.io"
insecure = false

[[registry.mirror]]
location = "quay.io"

[registry.auth]
username = "{{ rh_username }}"
password = "{{ rh_password | default('') }}"
{% else %}
# Red Hat registry credentials not configured
{% endif %}

[registries.search]
  registries = [
    {% for registry in container_registries %}
    "{{ registry }}",
    {% endfor %}
  ]

[registries]
{% for registry in container_registries %}
  {{ registry }} = {
    url = "{{ registry }}",
    username = "{{ rh_username }}",
    password = "{{ rh_password }}"
  }
{% endfor %}

# DNS settings
[network]
network_backend = "cni"
{% for server in dns_servers | default(['8.8.8.8', '8.8.4.4']) %}
nameservers = ["{{ server }}"]
{% endfor %}